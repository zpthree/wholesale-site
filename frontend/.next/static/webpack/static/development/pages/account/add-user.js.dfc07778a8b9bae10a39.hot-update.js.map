{"version":3,"file":"static/webpack/static/development/pages/account/add-user.js.dfc07778a8b9bae10a39.hot-update.js","sources":["webpack:///./components/CreateUser.js"],"sourcesContent":["import React, { Component } from 'react';\nimport { Mutation } from 'react-apollo';\nimport gql from 'graphql-tag';\nimport styled from 'styled-components';\nimport Form from './styles/Form';\nimport Btn from './styles/Btn';\nimport isEmpty from '../lib/isEmpty';\nimport {\n  validateFirstName,\n  validateUsername,\n  validatePermissions,\n  validatePassword,\n  validateConfirmPassword,\n  comparePasswords,\n} from '../lib/validation';\n\nconst CreateUserStyles = styled.div`\n  h4 {\n    color: ${props => props.theme.red};\n  }\n\n  h5 {\n    margin-bottom: 1rem;\n  }\n\n  .form-row.permissions .row-full {\n    @media screen and (min-width: 768px) {\n      display: flex;\n      flex-direction: row;\n\n      label p {\n        margin-right: 1rem;\n        margin-left: 0;\n      }\n    }\n  }\n`;\n\nconst CREATE_USER_MUTATION = gql`\n  mutation CREATE_USER_MUTATION(\n    $firstName: String!\n    $lastName: String\n    $company: String\n    $email: String\n    $address: String\n    $phone: String\n    $username: String!\n    $password: String!\n    $permissions: String!\n    $canOrder: Boolean!\n  ) {\n    createUser(\n      data: {\n        firstName: $firstName\n        lastName: $lastName\n        company: $company\n        email: $email\n        address: $address\n        phone: $phone\n        username: $username\n        password: $password\n        permissions: $permissions\n        canOrder: $canOrder\n        active: true\n      }\n    ) {\n      id\n    }\n  }\n`;\n\nclass CreateUser extends Component {\n  state = {\n    firstName: '', // required\n    lastName: '',\n    username: '', // required\n    company: '',\n    email: '',\n    permissions: '', // required\n    canOrder: false, // required - needs to be false by default\n    phone: '',\n    address: '',\n    password: '', // required\n    confirmPassword: '', // required\n    error: {},\n  };\n\n  handleChange = e => {\n    const { name, type, value } = e.target;\n    const val = type === 'number' ? parseFloat(value) : value;\n    this.setState({ [name]: val });\n  };\n\n  handleCheckbox = e => {\n    const { name } = e.target;\n    this.setState({ [name]: !this.state.canOrder });\n  };\n\n  validateInput = e => {\n    const { name, value } = e.target;\n    const error = {};\n    error[name] = '';\n    this.setState({ error: { ...this.state.error, ...error } });\n\n    if (name === 'firstName' && validateFirstName(value)) {\n      error.firstName = validateFirstName(value);\n    }\n\n    if (name === 'username' && validateUsername(value)) {\n      error.username = validateUsername(value);\n    }\n\n    if (name === 'permissions' && validatePermissions(value)) {\n      error.permissions = validatePermissions(value);\n    }\n\n    if (name === 'password' && validatePassword(value)) {\n      error.password = validatePassword(value);\n    }\n\n    if (name === 'confirmPassword' && validateConfirmPassword(value)) {\n      error.confirmPassword = validateConfirmPassword(value);\n    } else if (name === 'confirmPassword' && comparePasswords(value)) {\n      error.comparePasswords = comparePasswords(value);\n    }\n\n    this.setState({\n      error: {\n        ...this.state.error,\n        ...error,\n      },\n    });\n  };\n\n  validateForm = () => {\n    const error = {};\n\n    if (validateFirstName(this.state.firstName)) {\n      error.firstName = validateFirstName(this.state.firstName);\n    }\n\n    if (validateUsername(this.state.username)) {\n      error.username = validateUsername(this.state.username);\n    }\n\n    if (validatePermissions(this.state.permissions)) {\n      error.permissions = validatePermissions(this.state.permissions);\n    }\n\n    if (validatePassword(this.state.password)) {\n      error.password = validatePassword(this.state.password);\n    }\n\n    if (validateConfirmPassword(this.state.confirmPassword)) {\n      error.confirmPassword = validateConfirmPassword(\n        this.state.confirmPassword\n      );\n    } else if (comparePasswords(this.state.confirmPassword)) {\n      error.comparePasswords = comparePasswords(\n        this.state.password,\n        this.state.confirmPassword\n      );\n    }\n\n    this.setState({ error });\n  };\n\n  resetState = e => {\n    this.setState({\n      firstName: '', // required\n      lastName: '',\n      username: '', // required\n      company: '',\n      email: '',\n      permissions: '', // required\n      canOrder: false, // required - needs to be false by default\n      phone: '',\n      address: '',\n      password: '', // required\n      confirmPassword: '', // required\n      error: {},\n    });\n\n    window.scrollTo(0, 0);\n  };\n\n  render() {\n    const errorMessage = this.state.error;\n\n    return (\n      <Mutation mutation={CREATE_USER_MUTATION} variables={this.state}>\n        {(createUser, { loading, error }) => (\n          <CreateUserStyles>\n            <Form\n              method=\"post\"\n              onSubmit={async e => {\n                e.preventDefault();\n                this.validateForm();\n\n                if (!errorMessage) {\n                  const res = await createUser();\n                  this.resetState(e);\n                }\n              }}\n            >\n              <fieldset disabled={loading} aria-busy={loading}>\n                <h4>Add New User</h4>\n                <div className=\"form-body\">\n                  <div className=\"form-section\">\n                    <h5>User Information</h5>\n                    <div className=\"form-row info\">\n                      <div className=\"row-half\">\n                        <label htmlFor=\"firstName\">\n                          <p>First Name</p>\n                        </label>\n                        <input\n                          type=\"text\"\n                          id=\"firstName\"\n                          name=\"firstName\"\n                          value={this.state.firstName}\n                          onChange={this.handleChange}\n                          onBlur={this.validateInput}\n                          className={errorMessage.firstName ? 'error' : ''}\n                        />\n                        <p className=\"error\">\n                          {errorMessage.firstName && errorMessage.firstName}\n                        </p>\n                      </div>\n                      <div className=\"row-half\">\n                        <label htmlFor=\"lastName\">\n                          <p>\n                            Last Name <strong>&nbsp;(Optional)</strong>\n                          </p>\n                        </label>\n                        <input\n                          type=\"text\"\n                          id=\"lastName\"\n                          name=\"lastName\"\n                          value={this.state.lastName}\n                          onChange={this.handleChange}\n                        />\n                      </div>\n                    </div>\n\n                    <div className=\"form-row info\">\n                      <div className=\"row-half\">\n                        <label htmlFor=\"username\">\n                          <p>Username</p>\n                        </label>\n                        <input\n                          type=\"text\"\n                          id=\"username\"\n                          name=\"username\"\n                          value={this.state.username}\n                          onChange={this.handleChange}\n                          onBlur={this.validateInput}\n                          className={errorMessage.username ? 'error' : ''}\n                        />\n                        <p className=\"error\">\n                          {errorMessage.username && errorMessage.username}\n                        </p>\n                      </div>\n\n                      <div className=\"row-half\">\n                        <label htmlFor=\"company\">\n                          <p>\n                            Company <strong>&nbsp;(Optional)</strong>\n                          </p>\n                        </label>\n                        <input\n                          type=\"text\"\n                          id=\"company\"\n                          name=\"company\"\n                          value={this.state.company}\n                          onChange={this.handleChange}\n                        />\n                      </div>\n                    </div>\n\n                    <div className=\"form-row info\">\n                      <div className=\"row-full\">\n                        <label htmlFor=\"email\">\n                          <p>\n                            Email Address <strong>&nbsp;(Optional)</strong>\n                          </p>\n                        </label>\n                        <input\n                          type=\"email\"\n                          id=\"email\"\n                          name=\"email\"\n                          value={this.state.email}\n                          onChange={this.handleChange}\n                        />\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"form-section\">\n                    <h5>Permissions</h5>\n                    <div className=\"form-row info permissions\">\n                      <div\n                        className={`row-full ${\n                          errorMessage.permissions ? 'error' : ''\n                        }`}\n                      >\n                        <div className=\"permission-options\">\n                          <label htmlFor=\"customerPermissions\">\n                            Customer\n                            <input\n                              type=\"radio\"\n                              name=\"permissions\"\n                              id=\"customerPermissions\"\n                              value=\"CUSTOMER\"\n                              checked={\n                                this.state.permissions === 'CUSTOMER' &&\n                                'checked'\n                              }\n                              onChange={this.handleChange}\n                            />\n                          </label>\n                          <label htmlFor=\"employeePermissions\">\n                            Employee\n                            <input\n                              type=\"radio\"\n                              name=\"permissions\"\n                              id=\"employeePermissions\"\n                              checked={\n                                this.state.permissions === 'EMPLOYEE' &&\n                                'checked'\n                              }\n                              value=\"EMPLOYEE\"\n                              onChange={this.handleChange}\n                            />\n                          </label>\n                          <label htmlFor=\"adminPermissions\">\n                            Administrator\n                            <input\n                              type=\"radio\"\n                              name=\"permissions\"\n                              id=\"adminPermissions\"\n                              checked={\n                                this.state.permissions === 'ADMIN' && 'checked'\n                              }\n                              value=\"ADMIN\"\n                              onChange={this.handleChange}\n                            />\n                          </label>\n                        </div>\n\n                        <p className=\"error\">\n                          {errorMessage.permissions && errorMessage.permissions}\n                        </p>\n                      </div>\n                    </div>\n\n                    <div className=\"form-row info\">\n                      <div className=\"row-full can-order\">\n                        <label htmlFor=\"canOrder\">\n                          <p>Is this user allowed to create their own order?</p>\n                        </label>\n                        <input\n                          id=\"canOrder\"\n                          name=\"canOrder\"\n                          type=\"checkbox\"\n                          checked={this.state.canOrder === true && 'checked'}\n                          onChange={this.handleCheckbox}\n                        />\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* TODO: check privileges ?? */}\n\n                  <div className=\"form-section\">\n                    <h5>Contact Information</h5>\n                    <div className=\"form-row info\">\n                      <div className=\"row-full\">\n                        <label htmlFor=\"phone\">\n                          <p>\n                            Phone Number <strong>&nbsp;(Optional)</strong>\n                          </p>\n                        </label>\n                        <input\n                          type=\"text\"\n                          id=\"phone\"\n                          name=\"phone\"\n                          value={this.state.phone}\n                          onChange={this.handleChange}\n                        />\n                      </div>\n                    </div>\n\n                    <div className=\"form-row info\">\n                      <div className=\"row-full\">\n                        <label htmlFor=\"address\">\n                          <p>\n                            Street Address <strong>&nbsp;(Optional)</strong>\n                          </p>\n                        </label>\n                        <input\n                          type=\"text\"\n                          id=\"address\"\n                          name=\"address\"\n                          value={this.state.address}\n                          onChange={this.handleChange}\n                        />\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"form-section\">\n                    <h5>Password</h5>\n                    <div className=\"form-row info\">\n                      <div className=\"row-half\">\n                        <label htmlFor=\"password\">\n                          <p>\n                            {this.props.action === 'update' ? 'New ' : ''}\n                            Password\n                          </p>\n                        </label>\n                        <input\n                          type=\"password\"\n                          id=\"password\"\n                          name=\"password\"\n                          value={this.state.password}\n                          onChange={this.handleChange}\n                          onBlur={this.validateInput}\n                          className={errorMessage.password ? 'error' : ''}\n                        />\n                        <p className=\"error\">\n                          {errorMessage.password && errorMessage.password}\n                        </p>\n                      </div>\n                      <div className=\"row-half\">\n                        <label htmlFor=\"confirmPassword\">\n                          <p>Confirm Password</p>\n                        </label>\n                        <input\n                          type=\"password\"\n                          id=\"confirmPassword\"\n                          name=\"confirmPassword\"\n                          value={this.state.confirmPassword}\n                          onChange={this.handleChange}\n                          onBlur={this.validateInput}\n                          className={\n                            errorMessage.confirmPassword ? 'error' : ''\n                          }\n                        />\n                        <p className=\"error\">\n                          {errorMessage.confirmPassword &&\n                            errorMessage.confirmPassword}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"form-footer\">\n                  <Btn\n                    type=\"submit\"\n                    id=\"createUser\"\n                    name=\"createUser\"\n                    disabled={!isEmpty(errorMessage)}\n                  >\n                    Submit\n                  </Btn>\n                  <Btn\n                    type=\"cancel\"\n                    id=\"cancelUser\"\n                    name=\"cancelUser\"\n                    onClick={this.handleCancel}\n                  >\n                    Cancel\n                  </Btn>\n                </div>\n              </fieldset>\n            </Form>\n          </CreateUserStyles>\n        )}\n      </Mutation>\n    );\n  }\n}\n\nexport default CreateUser;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AASA;AAAA;AAAA;AAAA;AAEA;AAAA;AAoBA;AACA;AAgCA;;;;;;;;;;;;;;;;;;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAZA;AACA;AAcA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAIA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAZA;AACA;AAcA;AACA;AACA;;;;;;AACA;AAAA;AACA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AAHA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAKA;AACA;AAAA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAYA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AAIA;AATA;AAAA;AAAA;AAAA;AAAA;AAAA;AAYA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AAIA;AACA;AATA;AAAA;AAAA;AAAA;AAAA;AAAA;AAYA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AAGA;AACA;AARA;AAAA;AAAA;AAAA;AAAA;AAAA;AAaA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAaA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AACA;AACA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAnRA;AAkSA;;;;AA1ZA;AACA;AA4ZA;;;;A","sourceRoot":""}